## ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«ç†è§£ã¨ç”Ÿæˆã®çµ±ä¸€ / DeepSeek Janus, etc...

- Janus-Pro: Unified Multimodal Understanding and Generation with Data and Model Scaling
- [arXiv:2501.17811](https://arxiv.org/abs/2501.17811)

---

## ç›®æ¬¡

- ã¯ã˜ã‚ã«
- DeepSeek Janus (Pro)ã¨ã¯ï¼Ÿ
- ãƒ¢ãƒ‡ãƒ«ã®æ¦‚è¦
  - Janus (Pro)ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆç†è§£ï¼‰
  - Janus (Pro)ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆç”Ÿæˆï¼‰
  - ãƒ‡ãƒ¢
- Janusã‹ã‚‰å­¦ã¶
  - è¦–è¦šã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°åˆ†é›¢
  - å­¦ç¿’æˆ¦ç•¥
- ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«LLMã®æµã‚Œ
  - Chameleon
  - Janus
  - çµ±ä¸€ç”»åƒãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼
- ã¾ã¨ã‚
- å‚è€ƒæ–‡çŒ®ãªã©

---
layout: image-right
image: https://cdn.bsky.app/img/avatar/plain/did:plc:et47te5fb7uv64pbltu37lcc/bafkreihfnrk5dlh43swtcstq7io6ox32z5jflucd6afirfpfm3j4zbvrnm@jpeg
---

# ã¯ã˜ã‚ã«: è‡ªå·±ç´¹ä»‹

- åå‰: å°ç¬ åŸå¯›æ˜
- Twitter: [@xhiroga](https://twitter.com/xhiroga)
- Bluesky: [@hiroga.bsky.social](https://bsky.app/profile/hiroga.bsky.social)
- èˆˆå‘³é–¢å¿ƒ: ãŠçµµæã, 3D, CG, CV, ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«ãƒ¢ãƒ‡ãƒ«
- **ãƒ•ã‚©ãƒ­ãƒ¼**ã™ã‚‹ã¨ã€é–‹ç™ºã‚„èª¿ã¹ç‰©ã®æ§˜å­ãŒè¦‹ãˆã¾ã™ï¼

---

# ã¯ã˜ã‚ã«: ã©ã†ã—ã¦Janusã«ã¤ã„ã¦èª¿ã¹ãŸã®ï¼Ÿ

- ã‚ªãƒ¼ãƒ—ãƒ³ã‚¦ã‚§ã‚¤ãƒˆãªè‡ªå·±å›å¸°ãƒ¢ãƒ‡ãƒ«ã§ã€æœ€å…ˆç«¯ã®ç”»åƒç”Ÿæˆã«è¿½éšã™ã‚‹ãƒ¢ãƒ‡ãƒ«ãŒé‚ã«å‡ºã¦ããŸãŸã‚ã€‚
- ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«LLMã®ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’ã€ã“ã®æ©Ÿä¼šã«æ•´ç†ã—ãŸã„ã¨æ€ã£ãŸãŸã‚ï¼

---

# ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«ç†è§£ãƒ»ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã®ä½•ãŒå¬‰ã—ã„ã®ã‹ï¼Ÿ

- LLMãŒå›³è¡¨ã‚ã‚Šã§å¿œç­”ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ï¼
- Visual Chat & Interleaved Text/Image Generationã®ä¾‹ (Chameleon)

<img class="h-80" src="/chameleon-figure-7.png">

---

# DeepSeek Janus (Pro)ã¨ã¯ï¼Ÿ

- DeepSeek-LLMã‚’åŸºç›¤ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã€ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«å¯¾å¿œã®å­¦ç¿’ã‚’è¿½åŠ ã§è¡Œã£ãŸãƒ¢ãƒ‡ãƒ«ã€‚
- 2024å¹´10æœˆã«Janus-1.3BãŒå…¬é–‹ã•ã‚ŒãŸ
- 2025å¹´1æœˆã«Janus Pro 1B/7BãŒå…¬é–‹ã•ã‚ŒãŸ

---
layout: image-right
image: https://upload.wikimedia.org/wikipedia/commons/f/f4/Janus-Vatican.JPG
---

# ãƒˆãƒªãƒ“ã‚¢: ãƒ¤ãƒ¼ãƒŒã‚¹ã¨ã¯ï¼Ÿ

ãƒ­ãƒ¼ãƒç¥è©±ã®å‡ºå…¥å£ã®æ‰‰ã®å®ˆè­·ç¥ã€‚å…¥å£ã®ç¥ãªã®ã§ã€1å¹´ã®å§‹ã¾ã‚Šï¼1æœˆ(January)ã®å®ˆè­·ç¥ã§ã‚‚ã‚ã‚‹ã€‚[^Wikipedia_ãƒ¤ãƒ¼ãƒŒã‚¹]

[^Wikipedia_ãƒ¤ãƒ¼ãƒŒã‚¹]:https://ja.wikipedia.org/wiki/%E3%83%A4%E3%83%BC%E3%83%8C%E3%82%B9

---

## Janus (Pro)ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆç†è§£ï¼‰

```mermaid
flowchart LR
    t([ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ ğŸ’¬])
    i[ç”»åƒ ğŸï¸]
    t-->sft([SFTå½¢å¼ã«å¤‰æ›])
    sft--ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼-->token_without_image([ãƒˆãƒ¼ã‚¯ãƒ³<br/>ï¼ˆç”»åƒã®ãŸã‚ã®ç©ºãã‚¹ãƒšãƒ¼ã‚¹ã‚ã‚Šï¼‰])
    token_without_image-->token[ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆç”»åƒã¤ãï¼‰]
    i--SigLIP-->token
    
    token--LLM-->token
    token -- ãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼--> res[ãƒ¬ã‚¹ãƒãƒ³ã‚¹ ğŸ’¬]
```

**è£œè¶³**

- SFTå½¢å¼: `[{'role': '<|User|>', 'content': prompt}, {'role': '<|Assistant|>', ...}]`


---

## Janus (Pro)ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆç”Ÿæˆï¼‰

```mermaid
flowchart LR
    t([ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ ğŸ’¬])
    t-->sft([SFTå½¢å¼ã«å¤‰æ›])
    sft-->with_image_start_tag([image_start_tagã‚’ä»˜ä¸])
    with_image_start_tag--ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼-->token([ãƒˆãƒ¼ã‚¯ãƒ³])

    subgraph LlamaGenã¨åŒæ§˜
      token--LLM-->token
    end

    token -- ãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼--> o[å‡ºåŠ›ç”»åƒ ğŸï¸]
```

**è£œè¶³**

- image_start_tag: `<begin_of_image>`

---
layout: two-cols-header
---

## è§¦ã£ã¦ã¿ã‚ˆã†ï¼

::left::

## HuggingFace (Janus-Pro-7B)

https://huggingface.co/spaces/deepseek-ai/Janus-Pro-7B

::right::

## Google Colab

https://github.com/xhiroga/til/blob/main/software-engineering/deepseek-ai/Janus/_src/sandbox/Janus_Pro_1B.ipynb

---

# Janusã‹ã‚‰å­¦ã¶: è¦–è¦šã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®åˆ†é›¢

- ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«ç†è§£ãƒ»ç”Ÿæˆã‚¿ã‚¹ã‚¯ã§ã¯ã€ãã‚Œãã‚Œå¿…è¦ãªç†è§£åº¦ãŒç•°ãªã‚‹
  - ç†è§£ã‚¿ã‚¹ã‚¯ã§ã¯ç”»åƒã®æ¦‚è¦ãŒæ´ã‚ã‚Œã°è‰¯ã„
  - ç”Ÿæˆã‚¿ã‚¹ã‚¯ã§ã¯ãƒ”ã‚¯ã‚»ãƒ«ãƒ¬ãƒ™ãƒ«ã®ç´°éƒ¨ã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚‹
- Janusã§ã¯ã€ç†è§£ã¨ç”Ÿæˆã§åˆ¥ã€…ã®ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ç”¨ã„ã¦ã„ã‚‹
  - SigLIP
  - LlamaGenã§é–‹ç™ºã•ã‚ŒãŸVQ(ç”»åƒé‡å­åŒ–)ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼

---

# SigLIP

- GoogleãŒæ”¹è‰¯ã—ãŸCLIP
- ç”»åƒã¨ãƒ†ã‚­ã‚¹ãƒˆã®é¡ä¼¼æ€§ã‚’ç¢ºç‡ã§è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹

<img class="h-80" src="/tsutof-siglip.png">

å¼•ç”¨: [æ—¥æœ¬èªã«ã‚‚å¯¾å¿œã™ã‚‹ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«AIãƒ¢ãƒ‡ãƒ«SigLIPã§ã‚¼ãƒ­ã‚·ãƒ§ãƒƒãƒˆç”»åƒåˆ†é¡ã‚’è©¦ã™ / tsutof](https://zenn.dev/tsutof/articles/f53f035f8df9f3)

---

# LlamaGen

- LLMã®æ¬¡ãƒˆãƒ¼ã‚¯ãƒ³äºˆæ¸¬ã‚’ç”¨ã„ã¦ã€ç”»åƒã®æ¬¡ã®ãƒ‘ãƒƒãƒã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ã§ç”»åƒã‚’ç”Ÿæˆã™ã‚‹ãƒ¢ãƒ‡ãƒ«
- LlamaGenã®VQãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã¯ã€æ ¼å­çŠ¶ã«åˆ†å‰²ã—ãŸç”»åƒã®ãƒ‘ãƒƒãƒã‚’ã€æ•°åƒã€œæ•°ä¸‡ä»¥ä¸Šã®åˆ†é¡ã‹ã‚‰æœ€ã‚‚é¡ä¼¼ã—ãŸã‚³ãƒ¼ãƒ‰ã«å‰²ã‚Šå½“ã¦ã‚‹ï¼ˆï¼é‡å­åŒ–ï¼‰
- å‰å›ã®ç™ºè¡¨ã‚’ã”è¦§ãã ã•ã„ï¼

<img class="h-80" src="/llamagen-thumbnail.png">

---
layout: two-cols-header
---

# Janusã‹ã‚‰å­¦ã¶: å­¦ç¿’æˆ¦ç•¥

Janus Proã¯ã€Janusã¨æ¯”è¼ƒã—ã¦æ¬¡ã®é€šã‚Šæ”¹è‰¯ã•ã‚Œã¦ã„ã‚‹

::left::

## Janus 1.3Bã®å­¦ç¿’æˆ¦ç•¥

- Stage1: ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãƒ»ç”»åƒãƒ˜ãƒƒãƒ‰
  - è¦–è¦šã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ã¨LLMã¯å‡çµã—ã€å¤‰æ›ç”¨ã®å°ã•ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãƒ»ç”»åƒãƒ˜ãƒƒãƒ‰ï¼‰ã‚’è¨“ç·´
  - 10,000ã‚¹ãƒ†ãƒƒãƒ—
- Stage2: äº‹å‰å­¦ç¿’
  - ImageNetã‚’ç”¨ã„ãŸã‚«ãƒ†ã‚´ãƒªâ†’ç”»åƒã®å¤‰æ›ã€ãã‚Œä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã‚ˆã‚‹ãƒ†ã‚­ã‚¹ãƒˆâ†’ç”»åƒã®å¤‰æ›
  - 180,000ã‚¹ãƒ†ãƒƒãƒ—
- Stage3: æ•™å¸«ã‚ã‚Šãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
  - (å†…å®¹)
  - 24,000ã‚¹ãƒ†ãƒƒãƒ—

::right::

## Janus **Pro** 1Bã®å­¦ç¿’æˆ¦ç•¥

- Stage1
  - Janusã¨åŒæ§˜
  - **20,000**ã‚¹ãƒ†ãƒƒãƒ—
- Stage2: äº‹å‰å­¦ç¿’
  - å˜ç´”ãªã‚«ãƒ†ã‚´ãƒªâ†’ç”»åƒã®å¤‰æ›ã¯é¿ã‘ã€è©³ç´°ãªãƒ†ã‚­ã‚¹ãƒˆâ†’ç”»åƒã®å¤‰æ›ã«çµã£ã¦è¨“ç·´
  - **360,000**ã‚¹ãƒ†ãƒƒãƒ—
- Stage3: æ•™å¸«ã‚ã‚Šãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
  - Janusã¨åŒæ§˜
  - **80,000**ã‚¹ãƒ†ãƒƒãƒ—

---

# ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«LLMã®æµã‚Œ: Chameleon

TODO: ã“ã‚ŒãŒå‰æã§ã‚ã‚‹ã¨ã„ã†ã“ã¨ã‚ã‚Š

- Janusä»¥å‰ã‹ã‚‰ç™»å ´ã—ã¦ã„ãŸãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«ç†è§£ãƒ»ç”Ÿæˆãƒ¢ãƒ‡ãƒ«
- ç†è§£ã¨ç”Ÿæˆã§åŒä¸€ã®ç”»åƒãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ç”¨ã„ã¦ã„ã‚‹

<img class="h-80" src="/chameleon-figure-4.png">

---

# ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«LLMã®æµã‚Œ: Janus

---
layout: two-cols-header
---

# ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«LLMã®æµã‚Œ: çµ±ä¸€ç”»åƒãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼

TODO: çµ±ä¸€ç”»åƒãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã€ã¨ã„ã†ã®ã¯æ­£ã—ã„ï¼Ÿ

TODO: ã‚‚ã†ã¡ã‚‡ã£ã¨ç†è§£ã—ã¦æ›¸ãã€å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹ã«èª˜å°

:::left:::

- ç†è§£ã¨ç”Ÿæˆã§åŒä¸€ã®ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ç”¨ã„ã¤ã¤ã‚‚ã€ã‚¿ã‚¹ã‚¯ã”ã¨ã«ç•°ãªã‚‹ç‰¹æ€§ã‚’ç™ºæ®ã•ã›ã‚‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãŒææ¡ˆã•ã‚Œã¦ã„ã‚‹
- TokenFlowã¯ã€æ„å‘³çš„ãªç‰¹å¾´ã¨ãƒ”ã‚¯ã‚»ãƒ«ãƒ¬ãƒ™ãƒ«ã®è©³ç´°ã«å¯¾å¿œã—ãŸã€ãƒªãƒ³ã‚¯ã™ã‚‹2ã¤ã®ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã‚’æŒã¤ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’ææ¡ˆã—ã¦ã„ã‚‹

:::right:::

- TURINGãŒææ¡ˆã—ãŸOne-D-Pieceã§ã¯ã€ç”»åƒã®é‡è¦ãªæƒ…å ±ã‚’ãƒ™ã‚¯ãƒˆãƒ«ã®å…ˆé ­ã«é›†ä¸­ã•ã›ã‚‹ã“ã¨ã§ã€å…ˆé ­ã®ã‚±ã‚¿ã‚’ç”¨ã„ã‚Œã°å¿…è¦ãªè§£åƒåº¦ãŒå¾—ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹

---

# ãŠã™ã™ã‚è¨˜äº‹

TODO: ãªãœãŠã™ã™ã‚ï¼Ÿ

[![One-D-Piece](https://pbs.twimg.com/card_img/1886991035404050435/A65mMgoo?format=png&name=medium)](https://zenn.dev/turing_motors/articles/6d77c5a3b3712e)

---

# ã¾ã¨ã‚

- ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«ç†è§£ãƒ»ç”Ÿæˆãƒ¢ãƒ‡ãƒ«ã®æ”¹å–„ãŒç¶šã„ã¦ã„ã‚‹
- DeepSeek Janusã¯ç†è§£ãƒ»ç”Ÿæˆã®ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã‚’åˆ¥ã€…ã«ã™ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å–ã£ãŸ
- å¯å¤‰ã®ç”»åƒãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ãŒææ¡ˆã•ã‚Œã¤ã¤ã‚ã‚Šã€ä»Šå¾Œã®ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«LLMã«çµ„ã¿è¾¼ã¾ã‚Œã‚‹ã“ã¨ãŒäºˆæƒ³ã•ã‚Œã‚‹

---

# å‚è€ƒæ–‡çŒ® (1)

- C. Wu et al., â€œJanus: Decoupling Visual Encoding for Unified Multimodal Understanding and Generation,â€ Oct. 17, 2024, arXiv: arXiv:2410.13848. doi: 10.48550/arXiv.2410.13848.
- Y. Ma et al., â€œJanusFlow: Harmonizing Autoregression and Rectified Flow for Unified Multimodal Understanding and Generation,â€ Nov. 12, 2024, arXiv: arXiv:2411.07975. doi: 10.48550/arXiv.2411.07975.
- X. Chen et al., â€œJanus-Pro: Unified Multimodal Understanding and Generation with Data and Model Scaling,â€ Jan. 29, 2025, arXiv: arXiv:2501.17811. doi: 10.48550/arXiv.2501.17811.

---

# å‚è€ƒæ–‡çŒ® (2)

- X. Zhai, B. Mustafa, A. Kolesnikov, and L. Beyer, â€œSigmoid Loss for Language Image Pre-Training,â€ Sep. 27, 2023, arXiv: arXiv:2303.15343. doi: 10.48550/arXiv.2303.15343.
- P. Sun et al., â€œAutoregressive Model Beats Diffusion: Llama for Scalable Image Generation,â€ Jun. 10, 2024, arXiv: arXiv:2406.06525. doi: 10.48550/arXiv.2406.06525.
- C. Team, â€œChameleon: Mixed-Modal Early-Fusion Foundation Models,â€ May 16, 2024, arXiv: arXiv:2405.09818. doi: 10.48550/arXiv.2405.09818.
- L. Qu et al., â€œTokenFlow: Unified Image Tokenizer for Multimodal Understanding and Generation,â€ Dec. 04, 2024, arXiv: arXiv:2412.03069. doi: 10.48550/arXiv.2412.03069.
- K. Miwa, K. Sasaki, H. Arai, T. Takahashi, and Y. Yamaguchi, â€œOne-D-Piece: Image Tokenizer Meets Quality-Controllable Compression,â€ Jan. 17, 2025, arXiv: arXiv:2501.10064. doi: 10.48550/arXiv.2501.10064.

---

# é–¢é€£æƒ…å ±

- [Once you think they're done, Deepseek releases Janus-Series: Unified Multimodal Understanding and Generation Models](https://www.reddit.com/r/StableDiffusion/comments/1ibdhct/once_you_think_theyre_done_deepseek_releases/)
- [è«–æ–‡è§£èª¬ : Janus-Pro: Unified Multimodal Understanding andGeneration with Data and Model Scaling](https://note.com/atakana/n/nd1cb35aa5fe2)
- [å¯å¤‰å“è³ªã§ã®åœ§ç¸®ã‚’å®Ÿç¾ã™ã‚‹ç”»åƒãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ã€ŒOne-D-Pieceã€ã‚’å…¬é–‹ã—ã¾ã—ãŸ](https://zenn.dev/turing_motors/articles/6d77c5a3b3712e)
